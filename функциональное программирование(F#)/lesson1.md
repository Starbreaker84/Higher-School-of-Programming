# Часть первая. Введение

## 1. Введение

**1.1. Язык F#**

F# -- синтаксически минималистичный язык, во многом основанный на OCaml, и принадлежащий семейству языков MetaLanguage (ML).

Лучшие специалисты по computer science рекомендуют изучать функциональное программирование на языках ML-семейства.

Математическая модель ML-языков наиболее точно и полно отвечает нуждам продвинутого программирования.

F# очень активно развивается Microsoft, включён в качестве стандартного языка в Visual Studio.

Так как F# реализован на платформе .NET, в нём доступны все базовые и стандартные типы и структуры данных .NET, а также её различные дополнительные возможности.

Код, созданный на F#, можно включать в любые .NET-проекты -- например, в виде подключаемой библиотеки.

Далее рассматривается версия языка F# 2.0, компилятор 4.0.

**1.2. Программы на F#, сессии и скрипты**

На F# можно писать полноценные программы и затем компилировать и запускать их, например, с помощью Visual Studio.

Существуют онлайновые сервисы, поддерживающие F#, например:
[https://rextester.com/l/fsharp_online_compiler](https://rextester.com/l/fsharp_online_compiler)
[https://repl.it](https://repl.it/)

Файлы с кодом на F# имеют расширение .fs.

Однострочные комментарии в коде F# начинаются с символов //.

Многострочные комментарии заключаются в логические скобки (* и *).

С F# можно взаимодействовать интерактивно, в формате сессий, непосредственно из среды F# Interactive.

F# Interactive запускается файлом fsi.exe из каталога
C:\Program Files (x86)\Microsoft F#\v4.0

F# Interactive позволяет вводить команды и сразу получать результат; для завершения команды или группы команд надо ввести две точки с запятой ;;

F# активно применяется и в качестве скриптового интерпретируемого языка, на котором создаются сценарии, встраиваемые в программы на других языках. Файлы сценариев на F# имеют расширение .fsx

## 2. Принципы функционального программирования

**2.1. Функциональное программирование**

Функциональное программирование (фп) реализует не просто набор фич, а целостную концепцию программирования, основанную на математической теории лямбда-исчисления.

В фп мы используем: типы, выражения, функции и вычисления (вычислительные выражения).

Тип -- это абстракция, задающая структуру некоторого данного (например, диапазон его значений или допустимое поведение).

F# -- язык со строгой статической типизацией.

В F# вывод типа идентификатора или выражения осуществляется компилятором, анализирующим контекст его использования.

Компилятор пытается автоматически определить (вывести) тип каждого выражения в программе, и если это не удаётся, сообщает об ошибке.

Функции в F# -- такие же базовые типы данных, как например числа.

Выражение -- это комбинация функций и значений (параметров функций), возвращающая (вычисляющая) некоторый результат.

Программа на F# -- это единое выражение, которое вычисляется.

Программы на F# состоят не из команд и операций присваивания, а из применения функций к аргументам (аппликация).

**2.2. Вычисления и редукция**

Вычисление (редукция) выражения -- это его упрощение, понижение его сложности, сведение к более простому.

В процессе редукции могут получаться промежуточные более объёмные и более сложные синтаксически "упрощенные" выражения.

Редукция продолжается, пока не будет получен результат -- выражение, которое более невозможно упростить; как правило, это константы (числовые, строковые, ...).

В зависимости от способа (последовательности) применения упрощений можно получать различный итоговый результат.

Стратегия редукции задаёт конкретные правила применения упрощений.

Существуют две канонические стратегии редукции: жадная или энергичная (Innermost, eager), когда мы вычисляем аргументы функции ранее вычисления её самой, и ленивая (Outermost, lazy), когда мы не вычисляем аргументы функции, пока это реально не понадобится.

F# по умолчанию поддерживает энергичную стратегию редукции.

## 3. Первая программа на F#

**3.1. Программа на F#**

Программа на F# -- это последовательность выражений, в общем случае не требующая явного начала, точки входа и т. д.

Каждая "инструкция" (выражение) программы вычисляет некоторый результат, который используется не всегда.

Арифметические выражения числовых типов вычисляются с помощью операторов + - * / ** % и круглых скобок ( ).

```
2 * 3 + 4 // 10 
```

**3.2. Операция связывания**

Операция связывания в F# связывает некоторое значение с идентификатором (именем).

Формат операции связывания, называемой также объявлением (имени):

```
let имя = выражение
```

```
let X = 5 
```

let -- это ключевое слово, которое обязательно ставится в начале операции связывания.

X -- это идентификатор, который "именует" конкретное целое значение 5.

Идентификаторы, именующие значения, можно использовать в выражениях.

```
let Y = X - 5 // Y = 0 
```

Связывание выполняется однократно, в дальнейшем изменить значение имени невозможно.

Можно считать, что связывание задаёт в программе именованную константу.

**3.3. Система типов**

Система типов -- это строгий математический формализм, задающий потенциальную силу, выразительность конкретного языка программирования.
Именно мощность системы типов -- наиболее важная характеристика языка, определяющая его потенциал в борьбе со сложностью.
Система типов F# основана на лямбда-исчислении, дополнена богатым набором других сильных возможностей (параметрический полимфорфизм, безопасные алгебраические типы данных, ...) и существенно превосходит своим потенциалом популярные императивные языки программирования (C#, Java, Python, ...).
Фактически на этих языках невозможно делать многие вещи, допустимые в F#.

## 4. Вывод на экран

**4.1. Простой вывод строки**

Вывод строки на экран:

```
printfn "Hello, World!"
```

"Hello, World!" -- это выводимая на экран строка в двойных кавычках (значение строкового типа).

printfn -- это функция форматированного вывода на экран.

Параметры функций в F# не обязательно заключаются в ( ) , как часто принято в других языках, их можно просто указывать через пробел (но формально все функции в F# имеют только один аргумент, см. далее).

Функция printfn в дополнение к выводу на экран возвращает значение специального типа, определяющего тип и аргументы форматирования.

```
let X = printfn "Hello, World!" 
```

**4.2. Форматированный вывод**

Компилятор выполняет для всех функций статическую проверку типов её параметров.

printfn ожидает параметром (параметрами) строку, включающую возможно символы форматирования, и последующие значения (параметры) соответствующих типов.

Символы форматирования для вывода строк -- %s, для целых чисел -- %d, для вещественных чисел -- %f, для логических значений -- %b.

```
let X = 5 // имя X целого типа, этот тип выведен автоматически
printfn "X = %d" X // "X = 5"

printfn "X = %s" X // ошибка компиляции: ожидается строка, а X целого типа

printfn "X = %d %s" X ":)" // "X = 5 :)"
```

**4.3. Задания**

4.3.1. Напишите программу, выводящую строку "Hello, World!!!"

4.3.2. Напишите программу, вычисляющую и выводящую на экран значение выражения 2.1 + 3.2 * (8 / 4 + 1.3)

Шаблон для отправки на сервер:

```
// 4.3.1
printfn ...

// 4.3.2
printfn ...
```
