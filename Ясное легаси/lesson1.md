## Ясное легаси

### Легаси-код -- это код, для которого не написаны качественные тесты.

Либо тесты имеются, но настолько устарели или плохи, что легаси-код их давным давно не проходит.

Неважно, насколько хорошо написан легаси-код, в каком он стиле (императивный, ООП, функциональный, ...), в какой он архитектуре и т. д.

С помощью тестов мы можем быстро и под полным контролем менять поведение нашего кода и легко в нём разбираться.

А без тестов мы даже не знаем, становится ли наш код со временем лучше или хуже.

---

Предварительно настоятельно рекомендую изучить с курса карьеры материал по отладке, и две заметки -- по тестированию и TDD.

---

*По материалам учебника **"Working effectively with legacy code"**
и других работ автора [**Michael C. Feathers**](https://www.r7krecon.com/michael-feathers-bio)*

Четыре причины внесения изменений в код:

1. Добавление новой фичи
2. Исправление ошибки
3. Улучшение структуры кода и архитектуры (рефакторинг)
4. Оптимизация использования ресурсов (быстродействия, памяти, сети...)

Поведение (с точки зрения пользователя) -- важнейшая характеристика системы. Программист может либо добавлять новое поведение, либо менять (в вырожденном случае -- удалять) существующее поведение.

Однако новое/старое поведение с точки зрения пользователя и с точки зрения программиста могут кардинально различаться и не совпадать.

Первые две причины (фича и баг) подразумевают изменение поведения системы с точки зрения пользователя и соответственно добавление нового/изменение существующего поведения с точки зрения программиста.

Последние две причины (рефакторинг и оптимизация) подразумевают сохранение поведения системы с точки зрения пользователя и изменение существующего поведения (и изредка добавление нового) с точки зрения программиста.

Конечно, добавить новое поведение почти невозможно, не изменив в какой-то степени уже имеющееся "старое" поведение, но  **к полной автономности новой фичи всегда надо стремиться** .

### Легаси-система (задания)

======= 1. Легаси-код –- это (выберите неверное утверждение)...

[ ] код, для которого не написаны тесты

[ 1] небрежный код, в плохом стиле

[ ] код, покрытый тестами, которые не проходят успешно

======= 2. Фича и баг подразумевают ...

[ ] изменение поведения системы с точки зрения пользователя и изменение поведения системы с точки зрения программиста

[ 1] изменение поведения системы с точки зрения пользователя и добавление нового/изменение существующего поведения системы с точки зрения программиста

[ ] добавление нового/изменение существующего поведения системы с точки зрения пользователя и изменение поведения системы с точки зрения программиста

[ ] добавление нового/изменение существующего поведения системы с точки зрения пользователя и добавление нового/изменение существующего поведения системы с точки зрения программиста

======= 3. Рефакторинг и оптимизация подразумевают ...

[ ] изменение поведения системы с точки зрения пользователя и изменение поведения системы с точки зрения программиста

[ ] изменение поведения системы с точки зрения пользователя и добавление нового/изменение существующего поведения системы с точки зрения программиста

[ 1] добавление нового/изменение существующего поведения системы с точки зрения пользователя и изменение поведения системы с точки зрения программиста

[ ] добавление нового/изменение существующего поведения системы с точки зрения пользователя и добавление нового/изменение существующего поведения системы с точки зрения программиста
