### Тестирование ООП-кода

28. Проблема. Зачастую оказывается очень трудно создать экземпляр класса в процессе тестирования.

Четыре самых типичных затруднения:

1. Объекты класса не могут быть созданы просто и легко.
2. Средства тестирования не компонуются с используемым в них классом.
3. Конструктор класса, который требуется использовать, выдает ужасные побочные эффекты.
4. В конструкторе класса происходит нечто очень важное и требующее отдельного тщательного изучения.

Решение. Самый лучший способ выяснить, насколько сложным окажется получение экземпляра класса для тестирования -- просто попытаться это сделать. Напишите контрольный пример и попытайтесь создать в нём объект -- компилятор сообщит, что именно потребуется, чтобы получить работоспособный код.

### Тестирование ООП-кода

29. Проблема. При написании тестов объекту требуется аргумент, который сам по себе представляет трудно формируемый объект.

Решение. Рассмотрите возможность передачи нулевого значения (null/None): если соответствующий параметр действительно используется по ходу выполнения теста, то сгенерируется исключение, которое в ряде случаев можно считать минимально корректным поведением тестируемого метода.

### Тестирование ООП-кода

30. Проблема. В тестах необходимо поведение, которое требует реальный объект в качестве аргумента, или передача нулевого значения явно запрещена.

Решение. Если зависимость от параметра не закодирована жёстко в конструкторе, то можно переопределить метод в тестовом подклассе, и вообще избавиться от этого параметра.

### Тестирование ООП-кода

31. Проблема. Имеется метод, возвращающий объект-сотрудник по его идентификатору, но что возвратить, если работника с указанным номером не существует?

Решение. Применяем шаблон пустого объекта -- этот момент рассматривался на наших курсах по объектно-ориентированному проектированию. Во-первых, можно сгенерировать исключение, но тогда клиентам придётся явно обрабатывать ошибку. Во-вторых, можно возвратить нулевое значение, но и тогда клиентам придётся явно проверять нулевое значение. В-третьих (правильный вариант с первого курса ООАП), можно предварительно опросить статус объекта -- не выполнился ли данный метод неудачно? но и тут потребуются последующий явные проверки. Наконец, можно создать и вернуть "пустой" объект (самый нижний наследник, в идеале "замыкающий" всю иерархию, если допускается множественное наследование), что не потребует явных проверок в точке вызова этого метода, но, возможно, потребует обработки "пустых" объектов в других местах.

В целом, наличие подобных проблем говорит о том, что система спроектирована плохо: рекомендую изучить для начала материалы "3 уровня рассуждений о программе" из раздела Сильные Идеи.

### Тестирование ООП-кода (задания)

======= 28. Выберите ошибочное затруднение в создании экземпляра класса для тестирования

[ ] конструктор класса выдает побочные эффекты

[ 1] при создании объекта компилятор сообщает об ошибках

[ ] средства тестирования не компонуются с классом

[ ] в конструкторе класса происходит нечто очень важное

[ ] объекты не могут быть созданы легко и просто

======= 29. Что лучше, если методу в тестах надо передать трудно формируемый объект?

[ ] передавать нулевое значение

[ 1] передавать пустой объект

[ ] переопределить метод в тестовом подклассе
