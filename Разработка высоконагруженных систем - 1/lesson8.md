## 7. Документоориентированные базы данных

Тем не менее, документоориентированные базы данных сегодня получили очень широкое распространение, которое, пожалуй, уже сравнимо с популярностью реляционных СУБД. Точнее, не только документоориентированные, а вообще все, попадающие под определение NoSQL, и в частности, простая и эффективная модель данных  **ключ-значение** , которую мы рассмотрим далее.

Причины этому таковы:
- растёт потребность в растущем потенциале масштабирования, существенно превышающем возможности реляционных БД, в частности – требуется обработка очень больших наборов данных или очень большая пропускная способность по записи;
- выбор в пользу свободного программного обеспечения вместо коммерческих продуктов, лицензии на которые для масштабных проектов обходятся очень дорого;
- специализированные запросные операции, плохо поддерживаемые реляционной моделью;
- разочарование ограниченностью реляционных схем и стремление к более динамичным и выразительным моделям данных (как и в программировании, где выбор правильной и подходящей под конкретную задачу парадигмы серьёзно влияет на выразительность кода).

Документоориентированные базы данных снова возвращаются к иерархической модели прежде всего в плане  **сохранения вложенных записей -- связей «один-ко-многим» -- внутри их родительской записи** , вместо организации отдельной таблицы. Однако в вопросе представления связей «многие-к-одному» и «многие-ко-многим» и реляционные и документоориентированные базы данных, по большому счёту, не отличаются: в обоих случаях обращение к соответствующему элементу происходит с помощью уникального идентификатора, именуемого **внешним ключом (foreign key)** в реляционной модели, и **ссылкой на документ (document reference)** в документной модели. Этот идентификатор разрешается во время чтения с помощью соединения или дополнительных запросов. Пути, проложенному CODASYL, документоориентированные БД не следуют и по сей день.

Основные прикладные доводы в пользу документной модели данных таковы:

- высокая гибкость схемы (структуры) базы данных,
- лучшая производительность в ряде задач вследствие локальности данных и большей близости к «родным» структурам данных (например, словарям), применяемым в прикладной программной системе, взаимодействующей с СУБД.

Если структура данных в приложении — документоподобная (то есть представляет собой дерево связей «один-ко-многим», причем обычно всё дерево загружается сразу), то использование документной модели, вероятно, будет хорошей идеей.

Реляционная модель отвечает на это повышением продуктивности работы соединений и связей «многие-к-одному» и «многие-ко-многим», хотя тут имеются известные теоретические ограничения. Например, при использовании реляционной модели придётся дополнительно придерживаться методики  **расщепления (shredding) — разложения документоподобной структуры на множество таблиц** .

Какие моменты следует учитывать при выборе документоориентированной базы данных?

В документной модели, например, нельзя непосредственно ссылаться извне на некоторый вложенный элемент внутри документа. Приходится кодировать в режиме «второй элемент списка должностей для пользователя N 251» (что очень напоминает пути доступа в иерархической модели). Однако если вложенность документов не слишком велика (а на практике она чаще всего составляет максимум 2-3 уровня), то это обычно не представляет проблемы.

Плохая поддержка соединений в документоориентированных базах данных может быть, а может и не быть проблемой, в зависимости от проекта. Например, связи «многие-ко-многим» могут никогда не понадобиться в аналитическом приложении, использующем документоориентированную БД для ведения лога (записи времени наступления событий). Однако если в приложении активно используются связи «многие-ко-многим», то документная модель представляется менее привлекательной.

Количество необходимых соединений можно снизить путем денормализации, но и коду приложения, и, скорее всего, команде технического сопровождения, понадобится выполнять дополнительную работу по поддержанию денормализованных данных в согласованном состоянии

## Документоориентированные БД (задания)

======= 23. Абсолютный плюс документоориентированных СУБД - это...

[] лучшая производительность

[ ] открытый софт

[1] высокая гибкость схемы

[ ] специализированные запросные операции

[ ] повышение продуктивности работы соединений

======= 24. В чём конструктивно документоориентированные СУБД лучше реляционных?

[1] ссылки на другие документы

[ ] соединения и "многие-ко-многим"

[] локальность данных и близость к «родным» структурам

[ ] расщепление документов

[ ] ссылки на вложенные документы

======= 25. Что плохо влияет на работу документоориентированных СУБД?

[1] высокая вложенность документов

[] отношения "многие-ко-многим"

[ ] большое число соединений в запросах
