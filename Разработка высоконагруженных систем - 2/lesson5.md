## Отказы узлов

Потенциально любой узел может приостановить работу: из-за сбоя, запланированного технического обслуживания и т. д. Возможность перезагружать отдельные узлы без простоя системы -- огромное преимущество в смысле удобства эксплуатации и обслуживания. Следовательно, надо добиться, чтобы система продолжала работать, несмотря на отказы отдельных узлов.

Проблема 12. Отказ ведомого узла.

Решение. Каждый ведомый узел хранит на своём жестком диске локальный журнал полученных от ведущего узла изменений данных. В случае сбоя или перезагрузки ведомого узла или сбоя сети между ведущим и ведомым узлами последний может легко возобновить работу, так как по своему журналу знает, какая транзакция была обработана перед сбоем. Ему достаточно подключиться к ведущему узлу и запросить все изменения данных, имевшие место за то время, пока он был недоступен.


## Отказы узлов

Проблема 13. Отказ ведущего узла.

Решение. Необходимо повысить один из ведомых узлов до ведущего, настроить клиенты на отправку записей новому ведущему, а другие ведомые должны начать получать изменения данных от нового ведущего. Такой процесс называется  **восстановление после отказа (failover)** .

1. Установить конкретную причину отказа ведущего узла в общем случае невозможно, поэтому на практике используется стандартная метрика -- таймаут, превышение времени ожидания.
2. Выбрать новый ведущий узел. Узел может быть выбран методом round robin, или взят тот, у кого наиболее свежая реплика, или назначается уже предварительно выбранный узел-контроллер (controller node).
3. Настроить систему на использование нового ведущего узла. Клиенты должны быть оповещены о новом ведущем узле, старый ведущий узел переводится в ведомый, и ему сообщается новый ведущий.


### Отказы узлов (задания)

======= 13. Отказ ведомого узла ...

[1] ведомый узел использует для восстановления локальный журнал изменений

[] используем другой ведомый узел вместо сбойного

======= 14. Отказ ведущего узла ...

[ ] ведомый узел использует для восстановления локальный журнал изменений

[1] повышаем другой ведомый до ведущего
