## 50. Выражения последовательностей

**50.1. Общая форма генерации последовательностей**

Конструкция seq { seqexp } -- это общая форма генерации последовательностей, где seqexp -- выражение последовательностей.

Выражение последовательностей записывается в двух формах:

- yield элемент -- добавляет элемент к последовательности;
- yield! последовательность -- добавляет последовательность к последовательности.

Выражения последовательностей последовательно комбинируются при записи с новой строчки.

Три следующие конструкции сформируют одинаковые последовательности seq [1; 2; 3].

```
let sq1 = seq {
    yield 1
    yield 2
    yield 3 }

let sq2 = seq {
    yield 1
    yield! seq [2; 3] }

let sq3 = seq {
    yield! seq [1; 2]
    yield 3 }
```

Для формирования выражений последовательностей можно использовать локальные декларации let, условные формы if then else, и циклы for in do.

Генератор последовательности чётных чисел:

```
let f n = seq {
    for i in 1..n do 
      if i % 2 = 0 then
         yield i }
```

**50.2. Задания**

50.2.1-2. Определите последовательности из пп. 49.5.2 и 49.5.4 с помощью выражений последовательностей.

*49.5.2. Определите последовательность факториалов неотрицательных целых чисел 1,1,2,6,...,n!*

*49.5.4. Определите последовательность 0, -1, 1, -2, 2, -3, 3, ...*

Шаблон для отправки на сервер:

```
// 50.2.1
let fac_seq = ...

// 50.2.2
let seq_seq = ...
```

**[[ предыдущее ]](https://skillsmart.ru/fp/fsh/c0sf7ffs14.html)**

---

**Ответы на задания 49**

```
let even_seq = Seq.initInfinite (fun i -> (i+1)*2)

let factorial n =
    let rec f x a =
        if x <= 1 then a
        else f (x - 1) (a * x)
    f n 1
let fac_seq = Seq.initInfinite factorial

let seq_seq = Seq.initInfinite (fun n -> if n % 2 = 0 then n/2 else (-1) * (n + 1)/2)
```
