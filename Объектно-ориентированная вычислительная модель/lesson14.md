### Реализация классов

Рассмотрим лингвистическую абстракцию класса.  **Класс -- это просто значение, запись** , которая защищена от доступа за счёт обёртки, как мы рассматривали ранее.

Запись класса содержит:

- набор методов (в виде условной "таблицы", или списка методов). Каждый метод - это процедура с тремя параметрами:
  сообщение M (которое всегда является записью),
  дополнительный параметр S (состояние текущего объекта), и
  Self (ссылка на сам объект).
- набор имён атрибутов, задающих атрибуты, которыми будет обладать каждый экземпляр класса (объект). Каждый атрибут представляет собой ячейку с состоянием, доступ к которой осуществляется с помощью имени атрибута.

На практике эта схема дополняется различной технической спецификой, например статическим связыванием методов с Self.

### Реализация объектов

Существует универсальная функция New, которая создает объект из любого класса. Она начинается с разворачивания записи класса из её обёртки. Затем создаётся состояние объекта (запись) из атрибутов класса, и перебором всех полей записи каждое поле инициализируется ячейкой с несвязанным начальным значением.

Объект Obj, возвращаемый функцией New -- это процедура с одним параметром. Например, вызов

```
Obj M (передача сообщения M объекту Obj)
```

или, в обычном объектном синтаксисе,

```
Obj.M
```

вызывает процедуру Obj с параметром M, которая отыскивает нужный метод, соответствующий M, в таблице методов. Вследствие лексического замыкания состояние Obj доступно только внутри Obj. По сути, Obj -- это процедура с инкапсулированным состоянием.Но это формальное описание, на практике такая схема обычно существенно оптимизирована или вообще реализована по другому: как правило, обращения к объектам (вызовы их методов) так же эффективны, как и вызовы обычных функций.

### Реализация наследования

Наследование "вычисляет" новую запись класса, используя существующие записи классов, которые объединяются в соответствии с правилами наследования. Это определение немного упрощено, потому что оно не учитывает статическое связывание.

### Реализация объектной системы

======= 42. Запись класса содержит (выберите неверное утверждение)

[ 1] набор атрибутов

[ ] набор имён атрибутов

[ ] набор методов

======= 43. Объект -- это ...

[ 1] процедура с инкапсулированным состоянием

[ ] ячейка памяти

[ ] имя-указатель на ячейку памяти

======= 44. Наследование реализуется ...

[1 ] созданием новой записи класса на основе существующих записей классов

[ ] комбинированием существующих записей классов

[ ] как лингвистическая абстракция в процессе компиляции

### Курс успешно закончен!

Теперь вы можете самостоятельно реализовать ООП с использованием декларативной модели и состояния :)

Но главное, помните, что **ООП надо использовать очень осторожно, в основном там, где сложная система взаимосвязанных типов и явно требуется наследование: присутствует множество небольших сущностей, связанных в иерархию.** В остальных случаях лучше придерживаться декларативных подходов.
