### 15. Как писать декларативные программы?

Самый простой и прямой путь писать декларативные программы (или отдельные декларативные компоненты) -- это использовать рассмотренную в предыдущих разделах декларативную модель :)

Использовать переменные только для однократных присваиваний. Использовать только арифметические операции и операции (чистые функции) над списками и записями (классами без методов). Комбинировать декларативные операции, что даст на выходе тоже декларативную операцию.

Один из способов декларативного комбинирования -- это алгебраическое правило "equals can be replaced by equals" (равное заменяется равным), которое в программировании называется  **ссылочная прозрачность** , существенно упрощающая рассуждения о программе. Например, если известно, что f(a) = a^2, то мы можем заменить f(a) на a^2 в любом месте, где она встречается. Например, равенство b = 7*f(a)^2 станет b = 7*a^4.

С технической точки зрения,  **написать декларативную программу -- значит, спроектировать эту программу как множество определений чистых рекурсивных функций, комбинируя их по правилам программирования высшего порядка** .

**Прямая рекурсия** означает, что функция явно вызывается себя в своём теле. **Непрямая рекурсия** означает, что функция вызывает другую функцию, которая вызывает исходную функцию. **Программирование высшего порядка** означает, что функции могут получать функции как параметры и возвращать их в качестве результата. Этот подход лежит в основе фактически всех техник для построения абстракций, изучаемых на данном курсе.

Такой подход условно назовём **"декларативщина"** (declarativeness).

В частности, распространено неформальное определение декларативщины: когда программирование задаётся в терминах, **что надо сделать** (специфицируем результаты, которые мы хотим получить), а не в терминах, как добиться результатов (для чего требуется кодирование в классическом алгоритмическом смысле).

Итак, вышеописанные базовые принципы потенциально уже позволяют писать полностью декларативные программы в повседневной разработке -- на Java, C# и Python и других популярных императивных и ОО-языках. Таким образом, программы, придерживающиеся декларативной вычислительной модели, будут декларативными, однако подход этот не очень практичный. Существуют и другие способы создания программ, которые гарантированно будут декларативными.


### 16. Классификация декларативных программ по степени выразительности кода

Рассмотрим классификацию декларативных программ по их выразительности, чтобы определиться, какой подход на практике будет наиболее практичен.

1. **Дескриптивная декларативщина** (менее выразительная): декларативная программа просто определяет структуру данных. Это, например, языки HTML или XML, которые конечно слишком слабы, чтобы на них разрабатывать универсальные программы. Однако они удобны, когда требуются вычисления с соответствующими структурами данных (например, задать структуру документа, не указывая, как конкретно выполнять форматирование).
2. **Программируемая декларативность** (более выразительная). Это, например, язык, основанный на изученной декларативной вычислительной модели. Тут в свою очередь существуют два фундаментально отличных подхода:
   2.1.  **дефиниционная форма** , когда декларативщина есть свойство реализации компонента. Например, компонент, реализованный в декларативной модели, по определению будет гарантированно декларативным.
   2.2.  **наблюдаемая форма** , когда декларативщина есть свойство интерфейса компонента. Тут мы придерживаемся принципа абстракции: чтобы использовать компонент, достаточно знать его интерфейс, и не нужно знать реализацию. Компонент должен вести себя декларативно: быть независимым, stateless и детерминистичным, но необязательно реализованным в декларативной модели.


Для дефиниционной формы в свою очередь характерны два популярных стиля программирования: **логический** и  **функциональный** . В функциональном стиле компонент -- это математическая функция, в логическом -- логическая взаимосвязь. Формально манипулировать функциями или логическим кодом труднее, нежели в случае дескриптивных программ, однако к ним по прежнему хорошо применимы алгебраические правила.

В наблюдаемой форме компоненты могут быть реализованы в любой вычислительной модели: главное, что в нашей декларативной программе они ведут себя декларативно, и доступны только через свои публичные декларативные интерфейсы (в частности, в парадигме абстрактных типов данных, которые мы изучали на курсе по ООАП).


### 17. Языки спецификаций

**Декларативное программирование -- это про то, "что" надо сделать, а не "как".**

Крайние сторонники декларативного программирования подчас считают, что полностью отвязаны от реализации, и всё что у них есть -- это только спецификация. В этом смысле спецификация -- это программа. Формально это так, и математическое описание может быть реализовано весьма эффективно. Но на практике декларативные программы похожи на любые другие: им нужны алгоритмы, структуры данных, модульность/структуризация проекта и понятие приоритета операций. Они в итоге существенно больше своих спецификаций: приходится искать компромисс между эффективностью и выразительностью, удобством ручного программирования.

Можно определить декларативный язык, который будет существенно выразительнее простого языка, изученного на предыдущих занятиях. Такой язык называется  **языком спецификации** . Однако эффективно реализовать его практически невозможно. Это противоречие на практике решается например так: были созданы так называемые решатели теорем (theorem provers), которые выполняют различные формальные, математические вычисления. Однако они не полностью автономны, а подразумевают интерактивное взаимодействие с человеком. С их помощью разработчик может часто доказывать очень важные и серьёзные утверждения о своём коде, проверять различные характеристики программы (например, гарантированную семантическую корректность определённых функций). Пока на практике потенрциал теорем-пруверов ограничен программами небольшого объёма, хотя это очень перспективное направление.


### Как писать декларативные программы? (задания)

======= 31. Написать декларативную программу -- значит ... (выберите неверное утверждение)

[X] использовать переменные для присваиваний

[] комбинировать декларативные операции

[ ] использовать арифметические операции

[ ] использовать чистые рекурсивные функции

======= 32. Декларативное программирование задаётся в терминах

[ ] как надо сделать

[X] что надо сделать

[ ] зачем надо сделать

[ ] когда надо сделать

======= 33. Функциональный стиль программирования -- это ...

[X] дефиниционная (внутренняя) форма декларативности

[ ] наблюдаемая (внешняя) форма декларативности

======= 34. Язык спецификаций -- очень выразительный декларативный язык, однако ...

[X] реализовать его практически нереально

[ ] им нельзя пользоваться без решателей теорем

[ ] он получается слишком сложным
