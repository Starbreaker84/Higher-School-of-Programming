### 15. Плюсы и минусы разных подходов

Как правило, LSM-деревья обычно работают быстрее при записи, а B-деревья при чтении. Чтение выполняется медленнее на LSM-деревьях потому, что приходится просматривать несколько различных структур данных и SS-таблиц, находящихся на разных стадиях уплотнения. Однако эти оценки сильно зависят от нюансов конкретной рабочей нагрузки.

Индекс на основе B-дерева должен записывать каждый элемент данных по крайней мере дважды: один раз в журнал с упреждающей записью и второй — на саму страницу дерева (и вероятно, снова при разбиении страниц). Журналированные индексы тоже переписывают данные несколько раз из-за многократного уплотнения и слияния SS-таблиц. Эффект, при котором одна операция записи в БД приводит ко множеству операций записи на диск, известен под названием  **усиления записи (write amplification)** . Этот вопрос особенно важен в случае SSD, способных переписывать блоки лишь ограниченное количество раз до полного износа.

В приложениях, требующих больших объемов записи, узким местом может оказаться скорость, с которой база записывает данные на диск. В этом случае усиление записи напрямую влияет на производительность: чем больше подсистема хранения записывает на диск, тем меньше операций записи в секунду она может выполнить в рамках доступной ей полосы пропускания диска.

LSM-деревья обычно способны обеспечить большую пропускную способность, чем B-деревья, частично из-за их более слабого усиления записи, а частично в силу того, что они последовательно записывают компактные файлы SS-таблиц вместо перезаписи нескольких страниц дерева. Эта разница особенно существенна для магнитных жестких дисков, на которых последовательные операции записи работают намного быстрее, чем произвольные. LSM-деревья также лучше сжимаются, а следовательно, приводят к меньшему размеру файлов на диске, чем B-деревья.

Преимущество B-деревьев в том, что каждый ключ встречается в индексе только в одном месте, в то время как в журналированных подсистемах хранения может быть несколько копий одного ключа в разных сегментах. Эта особенность функционирования делает B-деревья привлекательными для тех баз данных, которые стремятся обеспечить выраженную транзакционность: во многих реляционных БД изоляция транзакций реализуется с помощью блокировок для диапазонов ключей, а в индексах на основе B-деревьев такие блокировки можно непосредственно привязать к дереву.

Итог такой, что B-деревья глубоко укоренились в архитектуре СУБД и обеспечивают неизменно хорошую производительность для многих видов нагрузки, поэтому маловероятно, что в ближайшее время от них откажутся. А в новых хранилищах данных становятся все более популярны журналированные индексы.

В целом не существует простого правила, которое бы позволило решить, какой тип подсистемы хранения лучше в конкретном случае -- это приходится проверять опытным путем.


## Плюсы и минусы разных подходов (задания)

======= 54. LSM-деревья и B-деревья

[ 1] LSM-деревья обычно работают быстрее при записи, а B-деревья быстрее при чтении

[ ] LSM-деревья обычно работают медленнее при записи, а B-деревья быстрее при чтении

[ ] LSM-деревья обычно работают быстрее при записи, а B-деревья медленнее при чтении

[ ] LSM-деревья обычно работают медленнее при записи, а B-деревья медленнее при чтении

======= 55. Усиление записи -- это когда...

[ ] несколько операций записи в БД приводит ко множеству операций записи на диск

[ 1] одна операция записи в БД приводит ко множеству операций записи на диск

[ ] множество операций записи в БД приводит к одной операции записи на диск

======= 56. Из-за более слабого усиления записи...

[ ] B-деревья способны обеспечить большую пропускную способность, чем LSM-деревья

[ 1] LSM-деревья способны обеспечить большую пропускную способность, чем B-деревья

======= 57. Преимущество того, что каждый ключ встречается в индексе только в одном месте, характерно для ...

[ ] журналированных подсистем

[ 1] B-деревьев

[ ] LSM-деревьев
